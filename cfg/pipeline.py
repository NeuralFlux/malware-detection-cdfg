import os

from cfg_building import CFGBuilder as CB
from feat_extraction import FeatureExtractor as FE

from tqdm import tqdm

if __name__ == "__main__":
    GRAPH_ROOT_DIR = 'hm_dojass3_samples/'
    for file_dir in tqdm(os.listdir(GRAPH_ROOT_DIR)):
        # get file name
        file_name = file_dir[5:]

        # extract CFGs and features
        cb = CB('/'.join([GRAPH_ROOT_DIR, file_dir, 'graphs/']))
        fe = FE(cb.func_graph_dict)
        fe.export_features(file_name)